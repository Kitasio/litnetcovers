<script type="module">
  import init, { multiply, create_cover } from '/uploads/pkg/litcovers_wasm.js';

  const params = {
    author_font: "Stig.ttf",
    author: "Prison Mike",
    author_position: "TopCenter",
    title_font: "Stig.ttf",
    title: "Harry Potter and other people",
    title_position: "BottomCenter",
    blend_mode: "Overlay",
    alfa: 3.0,
    image_url: "https://replicate.delivery/pbxt/pX5B4V8QzvKFBBk7CHm788FQZKeQXvO8RbhfGNLXpIbYcZUQA/out-0.png",
    line_length: 16,
  }

  async function run() {
    await init();

    function adder(a, b) {
      console.log(multiply(a, b))
    }

    function cover(base64_img, base64_font) {
      return create_cover(base64_img, base64_font, params)
    }

    window.adder = adder;
    window.cover = cover;
  }

  run();
</script>

<div x-data={"{ img_bytes: 'bytes',  img: '#{@img}', base64_img: '#{@base64_img}', base64_font: '#{@base64_font}' }"}>
  <h1><%= @title %></h1>
  <img id="ItemPreview" x-bind:src="img">
  <button @click="img_bytes = cover(base64_img, base64_font)">create cover</button>
  <pre x-text="img_bytes"></pre>
</div>
